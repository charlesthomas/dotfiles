#!/bin/bash

# awk bits stolen from:
# https://stackoverflow.com/a/59404597

mkdir -p resources/

awk '
/^kind:/{
  close(file)
  file="resources/"$NF".yaml"
}
file!="" && !/^--/{
  print > (file)
}
' ${1:-/dev/stdin}


for f in $(ls resources/*.yaml); do
    [[ "${f}" == "${1}" ]] && continue
    d="$(echo $f | cut -f 1 -d . | tr '[:upper:]' '[:lower:]')s.yaml"
    mv $f $d
done
